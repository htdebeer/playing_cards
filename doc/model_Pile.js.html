<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="utf-8">
    <title>model/Pile.js - Documentation</title>

    <script src="scripts/prettify/prettify.js"></script>
    <script src="scripts/prettify/lang-css.js"></script>
    <!--[if lt IE 9]>
      <script src="//html5shiv.googlecode.com/svn/trunk/html5.js"></script>
    <![endif]-->
    <link type="text/css" rel="stylesheet" href="styles/prettify.css">
    <link type="text/css" rel="stylesheet" href="styles/jsdoc.css">
</head>
<body>

<input type="checkbox" id="nav-trigger" class="nav-trigger" />
<label for="nav-trigger" class="navicon-button x">
  <div class="navicon"></div>
</label>

<label for="nav-trigger" class="overlay"></label>

<nav>
    <h2><a href="index.html">Home</a></h2><h3>Classes</h3><ul><li><a href="module-card_supplier_CardSupplier-CardSupplier.html">CardSupplier</a><ul class='methods'><li data-type='method'><a href="module-card_supplier_CardSupplier-CardSupplier.html#createCard">createCard</a></li></ul></li><li><a href="module-card_supplier_SVGCardsCardSupplier-SVGCardsCardSupplier.html">SVGCardsCardSupplier</a><ul class='methods'><li data-type='method'><a href="module-card_supplier_SVGCardsCardSupplier-SVGCardsCardSupplier.html#createCard">createCard</a></li></ul></li><li><a href="module-Deck-Deck.html">Deck</a><ul class='methods'><li data-type='method'><a href="module-Deck-Deck.html#addToPile">addToPile</a></li></ul></li><li><a href="module-EventAware-EventAware.html">EventAware</a><ul class='methods'><li data-type='method'><a href="module-EventAware-EventAware.html#emit">emit</a></li><li data-type='method'><a href="module-EventAware-EventAware.html#off">off</a></li><li data-type='method'><a href="module-EventAware-EventAware.html#on">on</a></li></ul></li><li><a href="module-model_Card-Card.html">Card</a><ul class='methods'><li data-type='method'><a href="module-model_Card-Card.html#.fromUnicode">fromUnicode</a></li><li data-type='method'><a href="module-model_Card-Card.html#.joker">joker</a></li><li data-type='method'><a href="module-model_Card-Card.html#equals">equals</a></li><li data-type='method'><a href="module-model_Card-Card.html#isAce">isAce</a></li><li data-type='method'><a href="module-model_Card-Card.html#isBlack">isBlack</a></li><li data-type='method'><a href="module-model_Card-Card.html#isClubs">isClubs</a></li><li data-type='method'><a href="module-model_Card-Card.html#isDiamonds">isDiamonds</a></li><li data-type='method'><a href="module-model_Card-Card.html#isFaceCard">isFaceCard</a></li><li data-type='method'><a href="module-model_Card-Card.html#isFacingDown">isFacingDown</a></li><li data-type='method'><a href="module-model_Card-Card.html#isFacingUp">isFacingUp</a></li><li data-type='method'><a href="module-model_Card-Card.html#isHearts">isHearts</a></li><li data-type='method'><a href="module-model_Card-Card.html#isJack">isJack</a></li><li data-type='method'><a href="module-model_Card-Card.html#isJoker">isJoker</a></li><li data-type='method'><a href="module-model_Card-Card.html#isKing">isKing</a></li><li data-type='method'><a href="module-model_Card-Card.html#isKnight">isKnight</a></li><li data-type='method'><a href="module-model_Card-Card.html#isPipsCard">isPipsCard</a></li><li data-type='method'><a href="module-model_Card-Card.html#isQueen">isQueen</a></li><li data-type='method'><a href="module-model_Card-Card.html#isRed">isRed</a></li><li data-type='method'><a href="module-model_Card-Card.html#isSpades">isSpades</a></li><li data-type='method'><a href="module-model_Card-Card.html#toString">toString</a></li><li data-type='method'><a href="module-model_Card-Card.html#toUnicode">toUnicode</a></li><li data-type='method'><a href="module-model_Card-Card.html#turn">turn</a></li></ul></li><li><a href="module-model_Model-Model.html">Model</a><ul class='methods'><li data-type='method'><a href="module-model_Model-Model.html#emit">emit</a></li></ul></li><li><a href="module-model_Pile-Pile.html">Pile</a><ul class='methods'><li data-type='method'><a href="module-model_Pile-Pile.html#add">add</a></li><li data-type='method'><a href="module-model_Pile-Pile.html#each">each</a></li><li data-type='method'><a href="module-model_Pile-Pile.html#forEach">forEach</a></li><li data-type='method'><a href="module-model_Pile-Pile.html#inspect">inspect</a></li><li data-type='method'><a href="module-model_Pile-Pile.html#isEmpty">isEmpty</a></li><li data-type='method'><a href="module-model_Pile-Pile.html#merge">merge</a></li><li data-type='method'><a href="module-model_Pile-Pile.html#pick">pick</a></li><li data-type='method'><a href="module-model_Pile-Pile.html#shuffle">shuffle</a></li><li data-type='method'><a href="module-model_Pile-Pile.html#split">split</a></li><li data-type='method'><a href="module-model_Pile-Pile.html#take">take</a></li></ul></li><li><a href="module-model_Table-Table.html">Table</a></li><li><a href="module-svg-SVG.html">SVG</a><ul class='methods'><li data-type='method'><a href="module-svg-SVG.html#create">create</a></li><li data-type='method'><a href="module-svg-SVG.html#group">group</a></li><li data-type='method'><a href="module-svg-SVG.html#rectangle">rectangle</a></li><li data-type='method'><a href="module-svg-SVG.html#use">use</a></li></ul></li><li><a href="module-view_Card-Card.html">Card</a><ul class='methods'><li data-type='method'><a href="module-view_Card-Card.html#configure">configure</a></li><li data-type='method'><a href="module-view_Card-Card.html#render">render</a></li></ul></li><li><a href="module-view_Pile-Pile.html">Pile</a><ul class='methods'><li data-type='method'><a href="module-view_Pile-Pile.html#render">render</a></li></ul></li><li><a href="module-view_Table-Table.html">Table</a><ul class='methods'><li data-type='method'><a href="module-view_Table-Table.html#isTable">isTable</a></li><li data-type='method'><a href="module-view_Table-Table.html#render">render</a></li><li data-type='method'><a href="module-view_Table-Table.html#startDragging">startDragging</a></li><li data-type='method'><a href="module-view_Table-Table.html#stopDragging">stopDragging</a></li></ul></li><li><a href="module-view_View-View.html">View</a><ul class='methods'><li data-type='method'><a href="module-view_View-View.html#configure">configure</a></li><li data-type='method'><a href="module-view_View-View.html#isTable">isTable</a></li><li data-type='method'><a href="module-view_View-View.html#render">render</a></li></ul></li></ul><h3>Modules</h3><ul><li><a href="module-card_supplier_CardSupplier.html">card_supplier/CardSupplier</a></li><li><a href="module-card_supplier_SVGCardsCardSupplier.html">card_supplier/SVGCardsCardSupplier</a></li><li><a href="module-Deck.html">Deck</a></li><li><a href="module-EventAware.html">EventAware</a></li><li><a href="module-model_Card.html">model/Card</a></li><li><a href="module-model_Model.html">model/Model</a></li><li><a href="module-model_Pile.html">model/Pile</a></li><li><a href="module-model_Table.html">model/Table</a></li><li><a href="module-svg.html">svg</a></li><li><a href="module-util.html">util</a><ul class='methods'><li data-type='method'><a href="module-util.html#~symbolToString">symbolToString</a></li></ul></li><li><a href="module-view_Card.html">view/Card</a></li><li><a href="module-view_Pile.html">view/Pile</a></li><li><a href="module-view_Table.html">view/Table</a></li><li><a href="module-view_View.html">view/View</a></li></ul>
</nav>

<div id="main">
    
    <h1 class="page-title">model/Pile.js</h1>
    

    



    
    <section>
        <article>
            <pre class="prettyprint source linenums"><code>/*
 * Copyright 2017 Huub de Beer &lt;huub@heerdebeer.org>
 *
 * This file is part of playing_cards.
 *
 * playing_cards is free software: you can redistribute it and/or modify it
 * under the terms of the GNU General Public License as published by the Free
 * Software Foundation, either version 3 of the License, or (at your option)
 * any later version.
 *
 * playing_cards is distributed in the hope that it will be useful, but
 * WITHOUT ANY WARRANTY; without even the implied warranty of MERCHANTABILITY
 * or FITNESS FOR A PARTICULAR PURPOSE.  See the GNU General Public License
 * for more details.
 *
 * You should have received a copy of the GNU General Public License along
 * with playing_cards.  If not, see &lt;http://www.gnu.org/licenses/>.
 * 
 */

/**
 * @module
 */
import {Model, EVENT_MODEL_CHANGE} from "./Model.js";

const _cards = new WeakMap();

/**
 * A pile of cards.
 *
 * @extends Model
 */
class Pile extends Model {
    /**
     * Create an empty pile.
     */
    constructor() {
        super();
        _cards.set(this, []);
    }

    /**
     * The number of cards in this pile.
     *
     * @return {integer} The number of cards in this pile.
     */
    get count() {
        return _cards.get(this).length;
    }

    /**
     * Get a list of the cards in this pile.
     *
     * @return {Card[]} The cards in this pile as an array.
     */
    get cards() {
        return _cards.get(this);
    }

    /**
     * Is this pile empty?
     *
     * @return {Boolean} True if this pile has no cards, false otherwise.
     */
    isEmpty() {
        return 0 >= this.count;
    }

    /**
     * Add a card to this pile.
     *
     * @param {Card} card - the card to add.
     * @param {integer} [index = pile.count] - the index to insert the card in
     * this pile. Defaults to the end of the pile.
     *
     * @return {Pile} Return this pile.
     *
     * @fire EVENT_MODEL_CHANGE
     *
     * @throw {Error} Index out of bounds.
     */
    add (card, index = this.count) {
        if (0 &lt;= index &amp;&amp; index &lt;= this.count) {
            _cards.get(this).splice(index, 0, card);
            this.emit(EVENT_MODEL_CHANGE, this);
            return this;
        } else {
            throw new Error("Index out of bounds");
        }
    }

    /**
     * Iterator over all cards of this pile.
     *
     * @return {iterator} 
     */
    *each() {
        for (const card of _cards.get(this)) {
            yield card;
        }
    }

    /**
     * Apply callback to each card in this pile.
     *
     * @param {Function} callback - the function to apply to each card in this
     * pile
     */
    forEach(callback) {
        _cards.get(this).forEach(callback);
    }

    /**
     * Pick a random card from this pile; the pile contains one card less
     * hereafter.
     *
     * @return {Card} the picked card.
     *
     * @fire EVENT_MODEL_CHANGE
     */
    pick() {
        const randomIndex = Math.floor(Math.random() * this.count);
        const card = _cards.get(this).splice(randomIndex, 1)[0];
        this.emit(EVENT_MODEL_CHANGE, this);
        return card;
    }

    /**
     * Take a card from this pile. The pile contains one card less.
     *
     * @param {integer} [index = this.count -1] - the index of the card to
     * take. Defaults to the top card.
     *
     * @return {Card} the top card
     *
     * @fire EVENT_MODEL_CHANGE
     */
    take(index = this.count - 1) {
        const card = _cards.get(this).splice(index, 1)[0];
        this.emit(EVENT_MODEL_CHANGE, this);
        return card;
    }

    /**
     * Inspect a card in this pile. The pile does not change.
     *
     * @param {integer} [index = top] - the index of the card to
     * inspect. Defaults to the top card
     *
     * @return {Card} the card to inspect.
     */
    inspect(index = this.count - 1) {
        return _cards.get(this)[index];
    }

    /**
     * Shuffle this pile.
     *
     * @return {Pile} this pile, shuffled.
     *
     * @fire EVENT_MODEL_CHANGE
     */
    shuffle() {
        _cards.get(this).sort(() => Math.random() - 0.5);
        this.emit(EVENT_MODEL_CHANGE, this);
        return this;
    }

    /**
     * Split this pile in a number of smaller piles. By default the pile is
     * split in two.
     *
     * @param {integer} [numberOfPiles = 2] - the number of piles to split
     * this pile into, defaults to 2.
     *
     * @return {Pile[]} An array of piles, this pile is the first in that list
     *
     * @fire EVENT_MODEL_CHANGE
     */
    split(numberOfPiles = 2) {
        if (Number.isInteger(numberOfPiles)) {
            const pileCount = Math.floor(this.count / numberOfPiles);
            const piles = [];
            piles.push(this);

            while (this.count > pileCount) {
                const pile = new Pile();

                while (pile.count &lt; pileCount) {
                    pile.add(this.take());
                }

                piles.push(pile);
            }

            this.emit(EVENT_MODEL_CHANGE, this);
            return piles;
        }
    }

    /**
     * Merge another pile with this pile. Other pile will be empty afterwards.
     *
     * @param {Pile} other - the other pile to merge with this one.
     *
     * @return {Pile} this pile.
     *
     * @fire EVENT_MODEL_CHANGE
     */
    merge(other) {
        while (!other.isEmpty()) {
            this.add(other.take(0));
        }
        this.emit(EVENT_MODEL_CHANGE, this);
        return this;
    }


    
}

export {
    Pile,
};
</code></pre>
        </article>
    </section>




</div>

<br class="clear">

<footer>
    Documentation generated by <a href="https://github.com/jsdoc3/jsdoc">JSDoc 3.4.3</a> on Wed Apr 19 2017 20:11:36 GMT+0200 (CEST) using the <a href="https://github.com/clenemt/docdash">docdash</a> theme.
</footer>

<script>prettyPrint();</script>
<script src="scripts/linenumber.js"></script>
</body>
</html>
